# Generator Scripts

This directory contains scripts and configuration files used for generating and maintaining the SonarQube PMD plugin.

## Scripts

### pmd7_rules_xml_generator.groovy

This script generates XML rule files for PMD 7. It:
- Processes rule definitions from PMD JARs
- Converts Markdown documentation to HTML
- Generates rules-java.xml and rules-kotlin.xml files
- Uses rule alternatives defined in JSON files

Usage: This script is typically executed during the build process to generate up-to-date rule definitions.

From the project root directory:

```commandline
./mvnw generate-resources -Pgenerate-pmd-rules -pl sonar-pmd-plugin
```

### generate_release_notes.groovy

This script compares two PMD rule XML files (an old version and a new version) and generates a Markdown report highlighting:
1. Rules that have been removed
2. Rules that have been added
3. Rules that remain unchanged

Usage:
```
./generate_release_notes.groovy [options]
```

Options:
- `-o, --old <file>`: Old rules XML file path
- `-n, --new <file>`: New rules XML file path
- `-r, --report <file>`: Output report file path
- `-v, --version <version>`: Version to use in the title
- `-ov, --oldversion <ver>`: Old version to use for old rules file name
- `-h, --help`: Show usage information

## Configuration Files

### renamed-java-rules.json

This file contains a mapping of renamed Java rules in PMD. It includes:
- The language (Java)
- A count of renamed rules
- A list of rules with their old name, new reference name, and category

**Warning:** This file should not be modified manually as it is generated by the build process.

### rule-alternatives-java.json

This file contains a mapping of PMD Java rules to their equivalent SonarQube rules. For each PMD rule, it provides:
- The SonarQube rule key (e.g., "java:S1694")
- A link to the SonarQube rule documentation

### old-rules-$version.xml

These files contain XML definitions of PMD rules from specific versions. They are used as reference files for the generate_release_notes.groovy script to compare with newer rule definitions.

**Warning:** These files should not be modified manually as they are copied from previous versions of the plugin.

## Scripts for Testing

### create_highly_compressed_jar.groovy

This script creates a highly compressed Jar file to test zip bomb detection.
The generated jar is moved to `../sonar-pmd-lib/src/test/resources/`

### create_java_rule_extractor_test_jar.groovy

This script creates a Jar file containing two test classes for the Java rule extractor.
The generated jar is moved to `../sonar-pmd-lib/src/test/resources/`
